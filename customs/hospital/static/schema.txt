CREATE TABLE IF NOT EXISTS library_book (
    id SERIAL PRIMARY KEY,
    create_uid INTEGER,
    create_date TIMESTAMP,
    write_uid INTEGER,
    write_date TIMESTAMP,
    name VARCHAR(256) NOT NULL,
    isbn VARCHAR(128),
    active BOOLEAN DEFAULT TRUE,
    date_published DATE,
    image BYTEA,
    publisher_id INTEGER REFERENCES res_partner(id),
    CONSTRAINT library_book_name_uniq UNIQUE (name)
);

CREATE TABLE IF NOT EXISTS library_book_res_partner_rel (
    book_id INTEGER REFERENCES library_book(id),
    partner_id INTEGER REFERENCES res_partner(id),
    CONSTRAINT library_book_res_partner_unique UNIQUE (book_id, partner_id)
);

CREATE INDEX IF NOT EXISTS idx_library_book_create_uid ON library_book (create_uid);
CREATE INDEX IF NOT EXISTS idx_library_book_write_uid ON library_book (write_uid);
CREATE INDEX IF NOT EXISTS idx_library_book_publisher_id ON library_book (publisher_id);
CREATE INDEX IF NOT EXISTS idx_library_book_date_published ON library_book (date_published);
